<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Wykład 2: Mocna własność Markowa | Stochastyczne modele układów oddziałujących 2024</title>
<meta name="author" content="Piotr Dyszewski">
<meta name="description" content="2024-10-10 Piotr Dyszewski Pojęcie czasu zatrzymania odgrywa kluczową rolę w teorii procesów stochastycznych. Są to losowe momenty adaptowalne do z góry zadanej filtracji. Jest to kluczowa...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="Wykład 2: Mocna własność Markowa | Stochastyczne modele układów oddziałujących 2024">
<meta property="og:type" content="book">
<meta property="og:image" content="/cover.png">
<meta property="og:description" content="2024-10-10 Piotr Dyszewski Pojęcie czasu zatrzymania odgrywa kluczową rolę w teorii procesów stochastycznych. Są to losowe momenty adaptowalne do z góry zadanej filtracji. Jest to kluczowa...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wykład 2: Mocna własność Markowa | Stochastyczne modele układów oddziałujących 2024">
<meta name="twitter:description" content="2024-10-10 Piotr Dyszewski Pojęcie czasu zatrzymania odgrywa kluczową rolę w teorii procesów stochastycznych. Są to losowe momenty adaptowalne do z góry zadanej filtracji. Jest to kluczowa...">
<meta name="twitter:image" content="/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="test.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Notatni do wykładu">Stochastyczne modele układów oddziałujących 2024</a>:
        <small class="text-muted">Notatni do wykładu</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Stochastyczne modele układów oddziałujących</a></li>
<li><a class="" href="section-sylabus.html">Sylabus</a></li>
<li><a class="" href="section-wyk%C5%82ad-1-%C5%82a%C5%84cuchy-markowa-w-czasie-ci%C4%85g%C5%82ym.html">Wykład 1: Łańcuchy Markowa w czasie ciągłym</a></li>
<li><a class="active" href="section-wyk%C5%82ad-2-mocna-w%C5%82asno%C5%9B%C4%87-markowa.html">Wykład 2: Mocna własność Markowa</a></li>
<li><a class="" href="section-wyk%C5%82ad-3-procesy-i-p%C3%B3%C5%82grupy-fellera.html">Wykład 3: procesy i półgrupy Fellera</a></li>
<li><a class="" href="section-wyk%C5%82ad-4-generatory.html">Wykład 4: Generatory</a></li>
<li><a class="" href="section-wyk%C5%82ad-5-od-generatora-do-p%C3%B3%C5%82grupy.html">Wykład 5: od generatora do półgrupy</a></li>
<li><a class="" href="section-wyk%C5%82ad-6-od-generatora-przez-p%C3%B3%C5%82grup%C4%99-do-procesu.html">Wykład 6: od generatora przez półgrupę do procesu</a></li>
<li><a class="" href="section-wyk%C5%82ad-7-rozk%C5%82ady-stacjonarne-zaburzenia-ruchu-browna.html">Wykład 7: Rozkłady stacjonarne, zaburzenia ruchu Browna</a></li>
<li><a class="" href="section-wyk%C5%82ad-8-uk%C5%82ady-spinowe.html">Wykład 8: Układy spinowe</a></li>
<li><a class="" href="section-wyk%C5%82ad-9-konstrukcja-system%C3%B3w-spinowych.html">wykład 9: Konstrukcja systemów spinowych</a></li>
<li><a class="" href="section-wyk%C5%82ad-10-procesy-dualne.html">Wykład 10: Procesy dualne</a></li>
<li><a class="" href="section-wyk%C5%82ad-11-the-voter-model-przypadek-rekurencyjny.html">Wykład 11: The voter model: przypadek rekurencyjny</a></li>
<li><a class="" href="section-wyk%C5%82ad-12-the-voter-model-przypadek-tranzytywny.html">Wykład 12: The voter model: przypadek tranzytywny</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="section-wykład-2-mocna-własność-markowa" class="section level1 unnumbered">
<h1>Wykład 2: Mocna własność Markowa<a class="anchor" aria-label="anchor" href="#section-wyk%C5%82ad-2-mocna-w%C5%82asno%C5%9B%C4%87-markowa"><i class="fas fa-link"></i></a>
</h1>
<p>2024-10-10</p>
<p><em>Piotr Dyszewski</em></p>
<p>Pojęcie czasu zatrzymania odgrywa kluczową rolę w teorii procesów stochastycznych.
Są to losowe momenty adaptowalne do z góry zadanej filtracji.
Jest to kluczowa koncepcj w silnej własności Markowa.
Będziemy korzystać z ciągłej filtracji <span class="math inline">\(\mathbb{F}=( \mathcal{F}_t )_{t \in \mathbb{R}_+}\)</span>.</p>
<div id="section-czasy-zatrzymania" class="section level2 unnumbered">
<h2>Czasy zatrzymania<a class="anchor" aria-label="anchor" href="#section-czasy-zatrzymania"><i class="fas fa-link"></i></a>
</h2>
<p>Przypomnijmy, że w czasie dyskretnym definicja czasu zatrzymania <span class="math inline">\(\tau\)</span> jest taka,
że <span class="math inline">\(\{ \tau = n \} \in \mathcal{F}_n\)</span> dla każdego naturalnego <span class="math inline">\(n\)</span>.
Jest to równoważne z warunkiem, że <span class="math inline">\(\{ \tau \leq n \} \in \mathcal{F}_n\)</span>
dla każdego naturalnego <span class="math inline">\(n\)</span>. W czasie ciągłym ta równoważność nie zachodzi,
ponieważ <span class="math inline">\([0, \infty)\)</span> nie jest przeliczalne.
Warunek analogiczny do tego drugiego jest naturalny do użycia w czasie ciągłym,
ponieważ zazwyczaj zdarzenie <span class="math inline">\(\{ \tau = t \}\)</span> ma zerowe prawdopodobieństwo dla każdego <span class="math inline">\(t\)</span>.</p>
<div class="definition">
<p><span id="section-def:1-54" class="definition"><strong>Definicja 4  </strong></span>Zmienna losowa <span class="math inline">\(\tau : \Omega \to [0, \infty]\)</span> nazywana jest <span class="math inline">\(\mathbb{F}\)</span>-czasem zatrzymania,
jeśli <span class="math inline">\(\{ \tau \leq t \} \in \mathcal{F}_t\)</span> dla każdego <span class="math inline">\(t \geq 0\)</span>.</p>
</div>
<p>W niektórych kontekstach filtracja <span class="math inline">\(\mathbb{F}\)</span>, z którą pracujemy,
jest na tyle regularna, że ułatwia to weryfikację, czy zmienna jest czasem zatrzymania.</p>
<div class="definition">
<p><span id="section-def:1-0" class="definition"><strong>Definicja 5  </strong></span>Powiemy, że filtracja <span class="math inline">\(\mathbb{F} = (\mathcal{F}_t)_{t \in \mathbb{R}_+}\)</span> jest prawostronnie ciągła, jeżeli
<span class="math display">\[
\mathcal{F}_t = \mathcal{F}_{t_+}, \qquad \text{gdzie} \qquad \mathcal{F}_{t+} := \bigcap_{s &gt; t} \mathcal{F}_s
\]</span>
dla każdego <span class="math inline">\(t \in \mathbb{R}_+\)</span>.</p>
</div>
<div class="exercise">
<p><span id="section-exr:1-55" class="exercise"><strong>Zadanie 1  </strong></span>Załóżmy, że filtracja <span class="math inline">\(\mathbb{F}\)</span> jest prawostronnie ciągła.
Wówczas <span class="math inline">\(\tau\)</span> jest czasem zatrzymania wtedy i tylko wtedy,
gdy <span class="math inline">\(\{ \tau &lt; t \} \in \mathcal{F}_t\)</span> dla każdego <span class="math inline">\(t \in \mathbb{R}_+\)</span>.</p>
</div>
<div class="exercise">
<p><span id="section-exr:2-1-57" class="exercise"><strong>Zadanie 2  </strong></span>Pokaż, że jeśli <span class="math inline">\(\tau_1\)</span> i <span class="math inline">\(\tau_2\)</span> są czasami zatrzymania,
to również <span class="math inline">\(\tau_1 \wedge \tau_2\)</span>, <span class="math inline">\(\tau_1 \vee \tau_2\)</span> i
<span class="math inline">\(\tau_1 + \tau_2\)</span> są czasami zatrzymania.</p>
</div>
<div class="exercise">
<p><span id="section-exr:2-1-58" class="exercise"><strong>Zadanie 3  </strong></span>Udowodnij, że jeśli <span class="math inline">\(\{\tau_n\}_{n \in \mathbb{N}}\)</span> jest ciągiem czasów zatrzymania,
które maleją do <span class="math inline">\(\tau\)</span>, to <span class="math inline">\(\tau\)</span> jest czasem zatrzymania.</p>
</div>
<p>Własność Markowa dotyczy warunkowej wartości oczekiwanej względem <span class="math inline">\(\mathcal{F}_s\)</span> dla ustalonego <span class="math inline">\(s\)</span>.<br>
Mocna własność Markowa jest analogiczna, ale warunkowanie odbywa się względem <span class="math inline">\(\sigma\)</span>-algebry <span class="math inline">\(\mathcal{F}_\tau\)</span>,
gdzie <span class="math inline">\(\tau\)</span> jest czasem stopu.
Składa się ona ze zdarzeń, które są określone przez przeszłość aż do czasu <span class="math inline">\(\tau\)</span>.</p>
<div class="definition">
<p><span id="section-def:2-1-62" class="definition"><strong>Definicja 6  </strong></span>Dla czasu zatrzymania <span class="math inline">\(\tau\)</span> kładziemy
<span class="math display">\[
\mathcal{F}_\tau = \left\{ A \in \mathcal{F} : A \cap \{ \tau \leq t \} \in \mathcal{F}_t \text{ dla każdego } t \in \mathbb{R}_+ \right\}.
\]</span></p>
</div>
<div class="exercise">
<p><span id="section-exr:2-1-63" class="exercise"><strong>Zadanie 4  </strong></span>Pokaż, że:</p>
<ol style="list-style-type: lower-alpha">
<li>
<span class="math inline">\(\mathcal{F}_\tau\)</span> jest <span class="math inline">\(\sigma\)</span>-algebrą,</li>
<li>Załóżmy, że <span class="math inline">\(\mathbb{F}\)</span> jest prawostronnie ciągła. Pokaż, że
<span class="math display">\[
\mathcal{F}_\tau = \{ A : A \cap \{ \tau &lt; t \} \in \mathcal{F}_t \text{ dla każdego } t \geq 0 \}.
\]</span>
</li>
</ol>
</div>
<p>Oto niektóre podstawowe własności <span class="math inline">\(\mathcal{F}_\tau\)</span>.</p>
<div class="theorem">
<p><span id="section-thm:1-65" class="theorem"><strong>Twierdzenie 4  </strong></span>Jeśli <span class="math inline">\(\tau\)</span>, <span class="math inline">\(\tau_n\)</span>, <span class="math inline">\(n \in \mathbb{N}\)</span> są czasasmi zatrzymania, to:</p>
<ol style="list-style-type: lower-alpha">
<li>
<span class="math inline">\(\tau\)</span> jest mierzalny względem <span class="math inline">\(\mathcal{F}_\tau\)</span>.</li>
<li>Jeśli <span class="math inline">\(\tau_n \downarrow \tau\)</span>, to <span class="math inline">\(\mathcal{F}_\tau = \bigcap_n \mathcal{F}_{\tau_n}\)</span>.</li>
<li>
<span class="math inline">\(\tau_1 \leq \tau_2\)</span> implikuje <span class="math inline">\(\mathcal{F}_{\tau_1} \subseteq \mathcal{F}_{\tau_2}\)</span>.</li>
</ol>
</div>
<div class="proof">
<p><span id="section-unlabeled-div-5" class="proof"><em>Proof</em>. </span>Zadanie.</p>
</div>
<div id="section-mocna-własność-markowa" class="section level3 unnumbered">
<h3>Mocna własność Markowa<a class="anchor" aria-label="anchor" href="#section-mocna-w%C5%82asno%C5%9B%C4%87-markowa"><i class="fas fa-link"></i></a>
</h3>
<div class="theorem">
<p><span id="section-thm:2-1-68" class="theorem"><strong>Twierdzenie 5  </strong></span>Niech <span class="math inline">\((\mathbb{P}, \mathbb{F})\)</span> będzie łańcuchem Markowa na przeliczalnej przestrzeni stanów <span class="math inline">\(S\)</span>.
Załóżmy, że <span class="math inline">\(Y\)</span> jest ograniczoną zmienną losową oraz że <span class="math inline">\(\tau\)</span> jest czasem zatrzymania.
Wówczas dla każdego <span class="math inline">\(x \in S\)</span>,
<span class="math display" id="eq:2-1-68">\[\begin{equation}
\mathbf{E}_x [ Y \circ \theta_\tau | \mathcal{F}_\tau]
= \mathbf{E}_{X(\tau)} [Y] \quad \mathbf{P}_x-\text{prawie na pewno} \quad \text{na} \quad \{\tau &lt; \infty\}.
\tag{2}
\end{equation}\]</span></p>
</div>
<p>Silna własność Markowa jest zazwyczaj używana w następujący sposób:
Przemnóż równość <a href="section-wyk%C5%82ad-2-mocna-w%C5%82asno%C5%9B%C4%87-markowa.html#eq:2-1-68">(2)</a> przez <span class="math inline">\(\mathbf{1}_{\{\tau &lt; \infty\}}\)</span>,
a następnie zastosuj <span class="math inline">\(\mathbf{E}_x\)</span>.
Wynik, z uwzględnieniem, że <span class="math inline">\(\{\tau &lt; \infty\} \in \mathcal{F}_\tau\)</span>, to:
<span class="math display">\[
\mathbf{E}_x \left[ Y \circ \theta_\tau \mathbf{1}_{\{\tau &lt; \infty\}} \right]
= \mathbf{E}_x \left[ \mathbf{E}_{X(\tau)} \left[ Y \right] \mathbf{1}_{\{ \tau &lt; \infty\}} \right].
\]</span></p>
<div class="proof">
<p><span id="section-unlabeled-div-6" class="proof"><em>Proof</em> (Twierdzenia <a href="#thm:2-1-68">5</a>). </span>Najpierw załóżmy, że <span class="math inline">\(\tau\)</span> przyjmuje wartości z przeliczalnego zbioru <span class="math inline">\(0 \leq t_1 \leq t_2 \leq \dots\)</span> oraz <span class="math inline">\(\infty\)</span>.
W tym przypadku silna własność Markowa sprowadza się do własności Markowa, jak teraz pokażemy.</p>
<p>Zauważmy, że prawa strona <a href="section-wyk%C5%82ad-2-mocna-w%C5%82asno%C5%9B%C4%87-markowa.html#eq:2-1-68">(2)</a> jest mierzalna względem <span class="math inline">\(\mathcal{F}_\tau\)</span>.
Musimy więc sprawdzić, że jeśli <span class="math inline">\(A \in \mathcal{F}_\tau\)</span> oraz <span class="math inline">\(A \subseteq \{\tau &lt; \infty\}\)</span>, to
<span class="math display">\[
\mathbf{E}_x \left[ Y \circ \theta_\tau \mathbf{1}_A \right]
= \mathbf{E}_x \left[ \mathbf{E}_{X(\tau)} \left[ Y \right] \mathbf{1}_A \right].
\]</span>
Aby to wykazać, napiszmy:
<span class="math display">\[\begin{multline*}
\mathbf{E}_x \left[ Y \circ \theta_\tau \mathbf{1}_A \right]
= \sum_{n \in \mathbb{N}} \mathbf{E}_x \left[ Y \circ \theta_{t_n} \mathbf{1}_{A \cap \{\tau = t_n\}} \right] \\
= \sum_{n \in \mathbb{N}} \mathbf{E}_x \left[ \mathbf{E}_{X(t_n)} \left[ Y \right] \mathbf{1}_{ A \cap \{\tau = t_n\}} \right]
=\mathbf{E}_x\left[ \mathbf{E}_{X(\tau)}[Y] \mathbf{1}_A\right].
\end{multline*}\]</span>
W drugim kroku skorzystaliśmy z własności Markowa, ponieważ
<span class="math display">\[
A \cap \{\tau = t_n\} \in \mathcal{F}_{t_n}
\]</span>
zgodnie z definicją <span class="math inline">\(\mathcal{F}_\tau\)</span>.</p>
<p>W drugim kroku uzasadnimy tezę dla dowolnych <span class="math inline">\(\tau\)</span> i <span class="math inline">\(Y\)</span> postaci
<span class="math display" id="eq:2-spec">\[\begin{equation}
Y(\omega) = \prod_{j=1}^m f_j(\omega(t_j)),
\tag{3}
\end{equation}\]</span>
dla pewnego <span class="math inline">\(m \in \mathbb{N}\)</span>,
<span class="math inline">\(t_1, \ldots, t_m \in \mathbb{R}_+\)</span> oraz ograniczonych funkcji
<span class="math inline">\(f_1, \ldots, f_m \colon S \to \mathbb{R}\)</span>.</p>
<p>Czas <span class="math inline">\(\tau\)</span> przybliżamy go od góry czasami stopu <span class="math inline">\(\{\tau_n\}_{n \in \mathbb{N}}\)</span> zdefiniowanymi przez
<span class="math display">\[
\tau_n = \frac{k + 1}{2^n} \quad \text{jeśli} \quad \frac{k}{2^n} \leq \tau &lt; \frac{k + 1}{2^n}.
\]</span>
dla dostatecznie dużych <span class="math inline">\(k\)</span>.
Weźmy teraz <span class="math inline">\(A \in \mathcal{F}_\tau \subseteq \mathcal{F}_{\tau_k}\)</span> takie, że <span class="math inline">\(A \subseteq \{\tau &lt; \infty\}\)</span>.
Z pierwszej części dowodu,
<span class="math display">\[
    \mathbf{E}_x \left[ Y \circ \theta_{\tau_k} \mathbf{1}_A \right]
    = \mathbf{E}_x\left[ \mathbf{E}_{X(\tau_k)}[Y] \mathbf{1}_A \right].
\]</span>
Musimy przejść do granicy, gdy <span class="math inline">\(k \to \infty\)</span>. Po prawej stronie,
<span class="math inline">\(\tau_k \downarrow \tau\)</span> i z prawostronnej ciągłości <span class="math inline">\(X(\tau_k) \to X(\tau)\)</span> w <span class="math inline">\(S\)</span>, czyli <span class="math inline">\(X(\tau_k) = X(\tau)\)</span> dla dostatecznie dużych <span class="math inline">\(k\)</span>.
Po lewej stronie, napiszmy
<span class="math display">\[\begin{equation*}
\left( Y \circ \theta_{\tau_k} \right)(\omega) = \prod_{m=1}^n f_m(\omega(t_m + \tau_k))
\to \prod_{m=1}^n f_m(\omega(t_m + \tau)) = \left( Y \circ \theta_\tau \right)(\omega).
\end{equation*}\]</span>
kiedy <span class="math inline">\(k \to \infty\)</span>, dzięki prawostronnej ciągłości ścieżek. To pokazuje tezę:
<span class="math display">\[
\mathbf{E}_x \left[ Y \circ \theta_\tau \mathbf{1}_A \right] = \mathbf{E}_x \left[ \mathbf{E}_{X(\tau)}[Y] \mathbf{1}_A \right].
\]</span>
W ostatnim kroku dowodu pokażemy tezę dla dowolnego <span class="math inline">\(Y\)</span>.
Dla dowolnego <span class="math inline">\(m \in \mathbb{N}\)</span> oraz <span class="math inline">\(t_1, \ldots, t_m \in \mathbb{R}_+\)</span> rozważmy <span class="math inline">\(\pi_{t_1, \ldots, t_m} \colon \Omega \to \mathbb{R}^m\)</span>
dane wzorem
<span class="math display">\[\begin{equation*}
  \pi_{t_1, \ldots, t_m}(\omega) = (\omega(t_1), \omega(t_2), \ldots, \omega(t_m)).
\end{equation*}\]</span>
Wówczas dla dowolnych <span class="math inline">\(A_1, A_2, \ldots, A_m \subseteq S\)</span>,
<span class="math display">\[\begin{equation*}
\pi_{t_1, \ldots, t_m}^{-1}[A_1\times A_2 \times \ldots \times A_m ]
= \{ \omega \in \Omega \: : \:
\omega(t_1) \in A_1, \ldots, \omega(t_m) \in A_m \}.
\end{equation*}\]</span>
Rozważmy teraz <span class="math inline">\(\pi\)</span>-układ
<span class="math display">\[\begin{equation*}
    \mathcal{B} = \left\{ \pi_{t_1, \ldots, t_m}^{-1}[A_1 \times A_2 \times \ldots \times A_m ] \: : \:  
    m \in \mathbb{N}, t_1, \ldots , t_m \in \mathbb{R}_+, \: A_1, \ldots , A_m \subseteq S \right\}.
\end{equation*}\]</span>
oraz <span class="math inline">\(\lambda\)</span>-układ
<span class="math display">\[\begin{equation*}
   \mathcal{L} = \left\{ G \in \mathcal{F} \: : \: \mathbf{P}_x \left[ \theta_\tau \in G, A \right] =
   \mathbf{E}_x \left[ \mathbf{P}_{X(\tau)} \left[ G \right] \mathbf{1}_{ A } \right] \text{ dla } A \in \mathcal{F}_\tau,
   \: A \subseteq \{\tau &lt; \infty\} \right\}.
\end{equation*}\]</span>
Aproksymując <span class="math inline">\(\mathbf{1}_{\pi_{t_1, \ldots, t_m}^{-1}[A_1 \times \ldots \times A_m]}\)</span>
zmiennymi <span class="math inline">\(Y\)</span> postaci <a href="section-wyk%C5%82ad-2-mocna-w%C5%82asno%C5%9B%C4%87-markowa.html#eq:2-spec">(3)</a>,
dostajemy <span class="math inline">\(\mathcal{B} \subseteq \mathcal{L}\)</span>.
Z lematu o <span class="math inline">\(\pi\)</span>-<span class="math inline">\(\lambda\)</span> układach mamy <span class="math inline">\(\mathcal{F} = \sigma(\mathcal{B}) \subseteq \mathcal{L}\)</span>.
Czyli dla każdego <span class="math inline">\(G \in \mathcal{F}\)</span>,
<span class="math display">\[\begin{equation*}
  \mathbf{P}_x \left[ \theta_\tau \in G, A \right] =  \mathbf{E}_x \left[ \mathbf{P}_{X(\tau)} \left[ G \right] \mathbf{1}_{A} \right]
\end{equation*}\]</span>
dla każdego <span class="math inline">\(A \in \mathcal{F}_\tau\)</span> takiego, że <span class="math inline">\(A \subseteq \{\tau &lt; \infty\}\)</span>.
Jest to równoważne naszej tezie dla <span class="math inline">\(Y = \mathbf{1}_G\)</span>.
Z liniowości teza jest zatem prawdziwa dla każdego <span class="math inline">\(Y\)</span> przyjmującego skończenie wiele wartości.
Zastosowanie standardowego twierdzenia granicznego dowodzi tezy dla dowolnego ograniczonego <span class="math inline">\(Y\)</span>.</p>
</div>
</div>
</div>
<div id="section-charakteryzacja" class="section level2 unnumbered">
<h2>Charakteryzacja<a class="anchor" aria-label="anchor" href="#section-charakteryzacja"><i class="fas fa-link"></i></a>
</h2>
<p>Zauważmy, że każda funkcja <span class="math inline">\(\omega \in \Omega\)</span> musi być następującego typu:
Istnieje <span class="math inline">\(t_1 \in (0, \infty]\)</span>, taki że <span class="math inline">\(\omega(t) = \omega(0)\)</span>
dla każdego <span class="math inline">\(t \in [0, t_1)\)</span>,
następnie, jeśli <span class="math inline">\(t_1 &lt; \infty\)</span>, istnieje <span class="math inline">\(t_2 \in (t_1, \infty]\)</span> taki,
że <span class="math inline">\(\omega(t) = \omega(t_1) \neq \omega(0)\)</span>
dla każdego <span class="math inline">\(t \in [t_1, t_2)\)</span>, i tak dalej.
Powyższe czasy <span class="math inline">\(t_1, t_2, \ldots\)</span> zależą oczywiście od wyboru <span class="math inline">\(\omega\)</span>.
Dla każdego <span class="math inline">\(\omega \in \Omega\)</span>, istnieje zatem ciąg
<span class="math display">\[
T_0(\omega) = 0 &lt; T_1(\omega) \leq T_2(\omega) \leq T_3(\omega) \leq \dots \leq \infty,
\]</span>
taki, że <span class="math inline">\(X_t(\omega) = X_0(\omega)\)</span> dla każdego <span class="math inline">\(t \in [0, T_1(\omega))\)</span>
oraz dla każdej liczby całkowitej <span class="math inline">\(i \geq 1\)</span>,
warunek <span class="math inline">\(T_i(\omega) &lt; \infty\)</span> implikuje <span class="math inline">\(T_i(\omega) &lt; T_{i+1}(\omega)\)</span>,
<span class="math inline">\(X_{T_i(\omega)}(\omega) \neq X_{T_{i-1}(\omega)}(\omega)\)</span> i
<span class="math inline">\(X_t(\omega) = X_{T_i(\omega)}(\omega)\)</span> dla każdego <span class="math inline">\(t \in [T_i(\omega), T_{i+1}(\omega))\)</span>.
Co więcej, <span class="math inline">\(T_n(\omega) \uparrow \infty\)</span>, gdy <span class="math inline">\(n \to \infty\)</span>.
Nietrudno jest sprawdzić, że <span class="math inline">\(T_0, T_1, T_2, \dots\)</span> są czasami stopu. Na przykład,
<span class="math display">\[
    \{ T_1 \leq t \} = \{X(t) \neq X(0)\} \cup \bigcup_{q \in (0, 1) \cap \mathbb{Q}} \{ X_q \neq X_0 \} \in \mathcal{F}_t.
\]</span>
Przypomnijmy, że dla <span class="math inline">\(\lambda &gt; 0\)</span>,
dodatnia zmienna losowa <span class="math inline">\(U\)</span> ma rozkład wykładniczy z parametrem <span class="math inline">\(\lambda\)</span>,
jeśli <span class="math inline">\(\mathbb{P}[U &gt; r] = e^{-\lambda r}\)</span>
dla każdego <span class="math inline">\(r \geq 0\)</span>.
W poniższym lemacie przyjmujemy konwencję, że zmienna losowa wykładnicza o parametrze <span class="math inline">\(0\)</span> jest równa <span class="math inline">\(\infty\)</span> prawie na pewno.</p>
<div class="lemma">
<p><span id="section-lem:2-6-18" class="lemma"><strong>Lemma 1  </strong></span>Niech <span class="math inline">\(x \in S\)</span>.
Istnieje rzeczywista liczba <span class="math inline">\(c(x) \geq 0\)</span>,
taka że zmienna losowa <span class="math inline">\(T_1\)</span> ma rozkład wykładniczy z parametrem <span class="math inline">\(c(x)\)</span>
pod <span class="math inline">\(\mathbf{P}_x\)</span>. Co więcej, jeśli <span class="math inline">\(c(x) &gt; 0\)</span>,
to <span class="math inline">\(T_1\)</span> i <span class="math inline">\(X_{T_1}\)</span> są niezależne pod <span class="math inline">\(\mathbf{P}_x\)</span>.</p>
</div>
<div class="proof">
<p><span id="section-unlabeled-div-7" class="proof"><em>Proof</em>. </span>Niech <span class="math inline">\(s, t \geq 0\)</span>. Mamy
<span class="math display">\[
\mathbf{P}_x[T_1 &gt; s + t] = \mathbf{E}_x[\mathbf{1}_{\{T_1 &gt; s\}} \Phi \circ \theta_s],
\]</span>
gdzie <span class="math inline">\(\Phi(\omega) = \mathbf{1}_{\{\omega(r)=\omega(0), \, \forall r \in [0,t]\}}\)</span>.
Używając własności Markowa, dostajemy
<span class="math display">\[\begin{multline*}
\mathbf{P}_x[T_1 &gt; s + t] = \mathbf{E}_x[\mathbf{1}_{\{T_1 &gt; s\}} \mathbf{E}_x[\Phi]] \\
= \mathbf{E}_x[\mathbf{1}_{\{T_1 &gt; s\}} \mathbf{P}_x[T_1 &gt; t]] = \mathbf{P}_x[T_1 &gt; s] \mathbf{P}_x[T_1 &gt; t],
\end{multline*}\]</span>
co implikuje, że <span class="math inline">\(T_1\)</span> ma rozkład wykładniczy pod <span class="math inline">\(\mathbf{P}_x\)</span>.</p>
<p>Załóżmy teraz, że <span class="math inline">\(c(x) &gt; 0\)</span>. Wówczas <span class="math inline">\(T_1 &lt; \infty\)</span>, <span class="math inline">\(\mathbf{P}_x\)</span> prawie na pewno.
Dla każdego <span class="math inline">\(t \geq 0\)</span> i <span class="math inline">\(y \in S\)</span>,
<span class="math display">\[\begin{equation*}
\mathbf{P}_x[T_1 &gt; t, X_{T_1} = y] = \mathbf{E}_x[\mathbf{1}_{\{T_1 &gt; t\}} \Psi \circ \theta_t ],
\end{equation*}\]</span>
gdzie dla <span class="math inline">\(\omega \in \Omega\)</span>, <span class="math inline">\(\Psi(\omega) = 0\)</span> jeśli <span class="math inline">\(\omega\)</span> jest stałe,
a w przeciwnym razie <span class="math inline">\(\Psi(\omega) = \mathbf{1}_{\{ \gamma_1(\omega) = y\}}\)</span>,
gdzie <span class="math inline">\(\gamma_1(\omega)\)</span> jest wartością <span class="math inline">\(\omega\)</span>
po jego pierwszym skoku. Zatem mamy
<span class="math display">\[\begin{multline*}
\mathbf{P}_x[T_1 &gt; t, X_{T_1} = y] =
\mathbf{E}_x [\mathbf{1}_{\{T_1 &gt; t\}} \mathbf{E}_x[\Psi ]] = \\ \mathbf{E}_x[\mathbf{1}_{\{T_1 &gt; t\}} \mathbf{P}_x[X_{T_1} = y]]
= \mathbf{P}_x[T_1 &gt; t] \mathbf{P}_x[X_{T_1} = y],
\end{multline*}\]</span>
co daje pożądaną niezależność.</p>
</div>
<p>Punkty, dla których <span class="math inline">\(c(x) = 0\)</span>,
są stanami pochłaniającymi dla procesu Markowa,
w tym sensie, że
<span class="math inline">\(\mathbf{P}_x[X_t = x, \, \forall t \geq 0] = 1\)</span>.
Dla każdych <span class="math inline">\(x, y \in S\)</span> definiujemy
<span class="math display">\[\begin{equation*}
\Pi(x, y) = \left\{ \begin{array}{cc} \mathbf{P}_x[X_{T_1} = y] &amp; c(x)&gt;0 \\ \delta_x(y) &amp; c(x)=0 \end{array}\right.
\end{equation*}\]</span>
Zauważmy, że <span class="math inline">\(\Pi(x, \cdot)\)</span> jest miarą prawdopodobieństwa na <span class="math inline">\(S\)</span>.</p>
<div class="theorem">
<p><span id="section-thm:2-6-19" class="theorem"><strong>Twierdzenie 6  </strong></span>Niech <span class="math inline">\((\mathbf{P}, \mathbb{F})\)</span> będzie łańcuchem Markowa
w czasie ciągłym takim, że <span class="math inline">\(\sup_{x \in S} c(x) &lt; \infty\)</span>.
Wówczas
<span class="math display">\[\begin{equation*}
\frac{\mathrm{d}}{\mathrm{d} t} \left. \mathbb{P}_x[X_t=y]\right|_{t=0} = c(x) \Pi(x,y).
\end{equation*}\]</span></p>
</div>
<div class="proof">
<p><span id="section-unlabeled-div-8" class="proof"><em>Proof</em>. </span>Jeśli <span class="math inline">\(c(x) = 0\)</span>, to <span class="math inline">\(\mathbf{P}_x[X_t=x] = \mathbf{P}_x[X_0 =x]=1\)</span>, i stąd
<span class="math display">\[\begin{equation*}
\lim_{t \to 0} \frac{\mathbf{P}_x[X_t=x] - 1}{t} = 0.
\end{equation*}\]</span>
Załóżmy teraz, że <span class="math inline">\(c(x) &gt; 0\)</span>. Najpierw zauważmy, że
<span class="math display" id="eq:2-6-1">\[\begin{equation}
\mathbf{P}_x[T_2 \leq t] = O\left(t^2\right)
\tag{4}
\end{equation}\]</span>
gdy <span class="math inline">\(t \to 0\)</span>. Rzeczywiście, używając silnej własności Markowa w <span class="math inline">\(T_1\)</span>,
<span class="math display">\[\begin{equation*}
\mathbf{P}_x[T_2 \leq t] \leq \mathbf{P}x[T_1 \leq t, T_2 \leq T_1 + t]
= \mathbf{E}_x[\mathbf{1}_{\{T_1 \leq t\}} \mathbf{E}_{X_{T_1}}[T_1 \leq t]],
\end{equation*}\]</span>
i możemy oszacować
<span class="math display">\[\begin{equation*}
\mathbf{P}_{X_{T_1}}[T_1 \leq t] \leq \sup_{y \in S} \mathbf{P}_y[T_1 \leq t] \leq \sup_{y \in S} c(y),
\end{equation*}\]</span>
co daje oczekiwany wynik, ponieważ mamy również <span class="math inline">\(\mathbf{P}_x[T_1 \leq t] \leq c(x)t\)</span>.
Z <a href="section-wyk%C5%82ad-2-mocna-w%C5%82asno%C5%9B%C4%87-markowa.html#eq:2-6-1">(4)</a> wynika, że
<span class="math display">\[\begin{multline*}
\mathbf{P}_x[X_t=y] = \mathbf{P}_x[X_t=y, \: T_1 &gt; t] + \mathbf{P}_x[X_{T_1}=y, \: T_1 \leq t] + O(t^2)
\\ = \delta_{x}(y) e^{-c(x)t} + \left(1 - e^{-c(x)t}\right)\Pi(x,y) + O(t^2),
\end{multline*}\]</span>
używając niezależności <span class="math inline">\(T_1\)</span> i <span class="math inline">\(X_{T_1}\)</span> oraz definicji
<span class="math inline">\(\Pi(x, y)\)</span>. Dochodzimy do wniosku, że
skoro <span class="math inline">\(\mathbf{P}_x[X_0=y] = \delta_x(y)\)</span>, to
<span class="math display">\[\begin{equation*}
\frac{\mathbf{P}_x[X_t=y]  -  \mathbf{P}_x[X_0=y]}{t} \to -c(x)\delta_{x}(y) + c(x)\Pi(x,y).
\end{equation*}\]</span>
co kończy dowód.</p>
</div>
<p>Kolejne twierdzenie dostarcza pełnego opisu ścieżek procesu <span class="math inline">\(X\)</span> pod <span class="math inline">\(\mathbf{P}_x\)</span>.
Dla uproszczenia zakładamy, że nie ma stanów pochłaniających,
ale czytelnik łatwo rozszerzy stwierdzenie na przypadek ogólny.</p>
<div class="theorem">
<p><span id="section-thm:2-6-20" class="theorem"><strong>Twierdzenie 7  </strong></span>Zakładamy, że <span class="math inline">\(c(y) &gt; 0\)</span> dla każdego <span class="math inline">\(y \in S\)</span> i że <span class="math inline">\(\sup_{y \in S} c(y) &lt; \infty\)</span>.
Niech <span class="math inline">\(x \in S\)</span>.
Wówczas, <span class="math inline">\(\mathbf{P}_x\)</span> p.n.,
czasy skoku <span class="math inline">\(T_1 &lt; T_2 &lt; T_3 &lt; \dots\)</span> są skończone, a
ciąg <span class="math inline">\(X_0, X_{T_1}, X_{T_2}, \dots\)</span> pod <span class="math inline">\(\mathbf{P}_x\)</span> jest dyskretnym łańcuchem Markowa
z macierzą przejścia <span class="math inline">\(\Pi\)</span> rozpoczętym w <span class="math inline">\(x\)</span>.
Ponadto, pod warunkiem <span class="math inline">\((X_0, X_{T_1}, X_{T_2}, \dots)\)</span>,
zmienne losowe <span class="math inline">\(T_1 - T_0, T_2 - T_1, \dots\)</span> są niezależne,
a dla każdej liczby całkowitej <span class="math inline">\(i \geq 0\)</span>,
rozkład warunkowy <span class="math inline">\(T_{i+1} - T_i\)</span> jest wykładniczy z parametrem <span class="math inline">\(c(X_{T_i})\)</span>.</p>
</div>
<div class="proof">
<p><span id="section-unlabeled-div-9" class="proof"><em>Proof</em>. </span>Zastosowanie silnej własności Markowa pokazuje,
że wszystkie czasy stopu <span class="math inline">\(T_1, T_2, \dots\)</span> są skończone <span class="math inline">\(\mathbf{P}_x\)</span>-p.n.
Następnie, niech <span class="math inline">\(y, z \in S\)</span>, a <span class="math inline">\(f_1, f_2 \colon S \to \mathbb{R}\)</span>.
Używając silnej własności Markowa w <span class="math inline">\(T_1\)</span>:
<span class="math display">\[\begin{multline*}
\mathbf{E}_x[\mathbf{1}_{\{X_{T_1} = y\}} f_1(T_1) 1_{\{X_{T_2} = z\}} f_2(T_2 - T_1)]\\
= \mathbf{E}_x[\mathbf{1}_{\{X_{T_1} = y\}} f_1(T_1) \mathbf{E}_x[\mathbf{1}_{\{X_{T_2} = z\}} f_2(T_2 - T_1)]] \\
= \Pi(x, y) \Pi(y, z) \int_0^\infty e^{-c(x)s_1} f_1(s_1)\mathrm{d} s_1 \int_0^\infty  e^{-c(y)s_2} f_2(s_2) \mathrm{d} s_2.
\end{multline*}\]</span>
Postępując indukcyjnie, otrzymujemy dla każdych <span class="math inline">\(y_1, \dots, y_p \in S\)</span> oraz <span class="math inline">\(f_1, \dots, f_p \colon S \to \mathbb{R}\)</span>:
<span class="math display">\[\begin{multline*}
\mathbf{E}_x[\mathbf{1}_{\{X_{T_1} = y_1\}} \mathbf{1}_{\{X_{T_2} = y_2\}} \dots \mathbf{1}_{\{X_{T_p} = y_p\}} f_1(T_1) f_2(T_2 - T_1) \dots f_p(T_p - T_{p-1})] \\
= \Pi(x, y_1) \Pi(y_1, y_2) \dots \Pi(y_{p-1}, y_p) \prod_{i=1}^p \left( \int_0^\infty e^{-c(y_{i-1})s} f_i(s) \mathrm{d} s\right),
\end{multline*}\]</span>
gdzie <span class="math inline">\(y_0 = x\)</span>.</p>
</div>
<p>Z powyższego twierdzenia wynika charakteryzacja łańcucha Markowa w terminach <span class="math inline">\(Q\)</span>-macierzy.
Przez <span class="math inline">\(\mathbb{F}^X = (\mathcal{F}_t^X)_t\)</span> oznaczać będziemy najmniejszą możliwą filtrację, tj.
<span class="math display">\[\begin{equation*}
\mathcal{F}_t = \sigma(X_s \: : \: s \leq t).
\end{equation*}\]</span></p>
<div class="corollary">
<p><span id="section-cor:6-21" class="corollary"><strong>Wniosek 1  </strong></span>Niech <span class="math inline">\(q = (q(x,y))_{x,y\in S}\)</span> będzie <span class="math inline">\(Q\)</span>-macierzą taką, że <span class="math inline">\(\sup_{x \in S}|q(x,x)| &lt; \infty\)</span>.
Wówczas istnieje jedyna rodzina miar
<span class="math inline">\(\mathbf{P}\)</span> taka, że <span class="math inline">\((\mathbf{P}, \mathbb{F}^X)\)</span> jest łańcuchem Markowa stowarzyszonym z <span class="math inline">\(Q\)</span>-macierzą <span class="math inline">\(q\)</span>.</p>
</div>
</div>
<div id="section-symulacja-łańcucha-markowa-w-czasie-ciągłym" class="section level2 unnumbered">
<h2>Symulacja łańcucha Markowa w czasie ciągłym<a class="anchor" aria-label="anchor" href="#section-symulacja-%C5%82a%C5%84cucha-markowa-w-czasie-ci%C4%85g%C5%82ym"><i class="fas fa-link"></i></a>
</h2>
<p>W tej sekcji przedstawimy, jak zaimplementować i zwizualizować łańcuch Markowa w czasie ciągłym z 5 stanami.</p>
<div class="sourceCode" id="section-cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Funkcja do symulacji łańcucha Markowa w czasie ciągłym</span></span>
<span><span class="va">simulate_markov_chain</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Q</span>, <span class="va">initial_state</span>, <span class="va">time_horizon</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span>
<span>  <span class="va">state</span> <span class="op">&lt;-</span> <span class="va">initial_state</span></span>
<span>  <span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">trajectory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">time</span> <span class="op">&lt;</span> <span class="va">time_horizon</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">rate</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">Q</span><span class="op">[</span><span class="va">state</span>, <span class="va">state</span><span class="op">]</span>  <span class="co"># Intensywność opuszczenia stanu</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">rate</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">break</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">waiting_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">rate</span><span class="op">)</span>  <span class="co"># Czas do następnego zdarzenia</span></span>
<span>    <span class="va">time</span> <span class="op">&lt;-</span> <span class="va">time</span> <span class="op">+</span> <span class="va">waiting_time</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">time</span> <span class="op">&gt;</span> <span class="va">time_horizon</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">break</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">time</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Prawdopodobieństwa przejść do innych stanów</span></span>
<span>    <span class="va">probs</span> <span class="op">&lt;-</span> <span class="va">Q</span><span class="op">[</span><span class="va">state</span>, <span class="op">]</span></span>
<span>    <span class="va">probs</span><span class="op">[</span><span class="va">state</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>  <span class="co"># Usuwamy intensywność własną</span></span>
<span>    <span class="va">probs</span> <span class="op">&lt;-</span> <span class="va">probs</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">states</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">probs</span><span class="op">)</span>  <span class="co"># Nowy stan</span></span>
<span>    <span class="va">trajectory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">trajectory</span>, <span class="va">state</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">times</span>, state <span class="op">=</span> <span class="va">trajectory</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Macierz przejść (generator Q)</span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,  <span class="fl">1</span>,  <span class="fl">1</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,</span>
<span>               <span class="fl">1</span>, <span class="op">-</span><span class="fl">3</span>,  <span class="fl">1</span>,  <span class="fl">1</span>,  <span class="fl">0</span>,</span>
<span>               <span class="fl">1</span>,  <span class="fl">1</span>, <span class="op">-</span><span class="fl">3</span>,  <span class="fl">0</span>,  <span class="fl">1</span>,</span>
<span>               <span class="fl">0</span>,  <span class="fl">1</span>,  <span class="fl">0</span>, <span class="op">-</span><span class="fl">2</span>,  <span class="fl">1</span>,</span>
<span>               <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">1</span>,  <span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Symulacja łańcucha Markowa</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>  <span class="co"># Ustalenie ziarna dla powtarzalności wyników</span></span>
<span><span class="va">initial_state</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">czas_horyzont</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">simulate_markov_chain</span><span class="op">(</span><span class="va">Q</span>, <span class="va">initial_state</span>, <span class="va">czas_horyzont</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Przygotowanie danych do wykresu kawałkami stałego</span></span>
<span><span class="va">prepare_data_for_step</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    x_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">time</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    x_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">time</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">state</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Przygotowanie danych</span></span>
<span><span class="va">step_data</span> <span class="op">&lt;-</span> <span class="fu">prepare_data_for_step</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tworzenie wykresu kawałkami stałego</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">step_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_start</span>, y <span class="op">=</span> <span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xend <span class="op">=</span> <span class="va">x_end</span>, yend <span class="op">=</span> <span class="va">state</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Symulacja łańcucha Markowa w czasie ciągłym"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Czas"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Stan"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="StochastyczneModeleUkladowOddzialujacych2024_files/figure-html/continuous-markov-chain-1.png" width="672"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="section-wyk%C5%82ad-1-%C5%82a%C5%84cuchy-markowa-w-czasie-ci%C4%85g%C5%82ym.html">Wykład 1: Łańcuchy Markowa w czasie ciągłym</a></div>
<div class="next"><a href="section-wyk%C5%82ad-3-procesy-i-p%C3%B3%C5%82grupy-fellera.html">Wykład 3: procesy i półgrupy Fellera</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#section-wyk%C5%82ad-2-mocna-w%C5%82asno%C5%9B%C4%87-markowa">Wykład 2: Mocna własność Markowa</a></li>
<li>
<a class="nav-link" href="#section-czasy-zatrzymania">Czasy zatrzymania</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#section-mocna-w%C5%82asno%C5%9B%C4%87-markowa">Mocna własność Markowa</a></li></ul>
</li>
<li><a class="nav-link" href="#section-charakteryzacja">Charakteryzacja</a></li>
<li><a class="nav-link" href="#section-symulacja-%C5%82a%C5%84cucha-markowa-w-czasie-ci%C4%85g%C5%82ym">Symulacja łańcucha Markowa w czasie ciągłym</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Stochastyczne modele układów oddziałujących 2024</strong>: Notatni do wykładu" was written by Piotr Dyszewski. It was last built on 2025-01-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
